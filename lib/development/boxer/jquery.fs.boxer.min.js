/* 
 * Boxer v3.0.0 - 2014-01-04 
 * A jQuery plugin for displaying images, videos or content in a modal overlay. Part of the Formstone Library. 
 * http://formstone.it/boxer/ 
 * 
 * Copyright 2014 Ben Plum; MIT Licensed 
 */ 

!function(a,b){"use strict";function c(b){return F.formatter=k,a(this).on("click.boxer",a.extend({},F,b||{}),d)}function d(c){C(c);var d=a(this),e=c.data.$object,f=d[0].attributes?d.attr("href")||"":"",k=f.toLowerCase().split("."),l=k[k.length-1],m=d.data("type")||"",n="image"===m||"jpeg"===l||"jpg"===l||"gif"===l||"png"===l||"data:image"===f.substr(0,10),o=f.indexOf("youtube.com/embed")>-1||f.indexOf("player.vimeo.com/video")>-1,v="url"===m||!n&&!o&&"http"===f.substr(0,4),w="element"===m||!n&&!o&&!v&&"#"===f.substr(0,1),x="undefined"!=typeof e;if(a("#boxer").length<1&&(n||o||v||w||x)){if(D={$window:a(b),$body:a("body"),$target:d,$object:e,visible:!1,resizeTimer:null,touchTimer:null,gallery:{active:!1},options:c.data,isMobile:(E||c.data.mobile)&&!w},D.type=n?"image":o?"video":"element",n||o){var y=D.$target.attr("rel");"undefined"!=typeof y&&y!==!1&&(D.gallery.active=!0,D.gallery.rel=y,D.gallery.$items=a("a[rel= "+D.gallery.rel+"]"),D.gallery.index=D.gallery.$items.index(D.$target),D.gallery.total=D.gallery.$items.length-1)}var z="";D.isMobile||(z+='<div id="boxer-overlay" class="'+D.options.customClass+'" style="opacity: 0"></div>'),z+='<div id="boxer" class="loading '+D.options.customClass,D.isMobile&&(z+=" mobile"),v&&(z+=" iframe"),(w||x)&&(z+=" inline"),z+='" style="opacity: 0;',D.options.fixed===!0&&(z+=" position: fixed;"),z+='">',z+='<span class="boxer-close">'+D.options.labels.close+"</span>",z+='<div class="boxer-container" style="',z+=D.isMobile?"height: 100%; width: 100%":"height: "+D.options.height+"px; width: "+D.options.width+"px",z+='">',z+='<div class="boxer-content" style="opacity: 0;">',(n||o)&&(z+='<div class="boxer-meta">',D.gallery.active?(z+='<div class="boxer-arrow previous">'+D.options.labels.previous+"</div>",z+='<div class="boxer-arrow next">'+D.options.labels.next+"</div>",z+='<p class="boxer-position"',D.gallery.total<1&&(z+=' style="display: none;"'),z+=">",z+='<span class="current">'+(D.gallery.index+1)+"</span> "+D.options.labels.count+' <span class="total">'+(D.gallery.total+1)+"</span>",z+="</p>",z+='<div class="boxer-caption gallery">'):z+='<div class="boxer-caption">',z+=D.options.formatter.apply(D.$body,[D.$target]),z+="</div></div>"),z+="</div></div></div>",D.$body.append(z),D.$overlay=a("#boxer-overlay"),D.$boxer=a("#boxer"),D.$container=D.$boxer.find(".boxer-container"),D.$content=D.$boxer.find(".boxer-content"),D.$meta=D.$boxer.find(".boxer-meta"),D.$position=D.$boxer.find(".boxer-position"),D.$caption=D.$boxer.find(".boxer-caption"),D.$arrows=D.$boxer.find(".boxer-arrow"),D.$animatables=a("#boxer-overlay, #boxer, .boxer-container"),D.paddingVertical=parseInt(D.$boxer.css("paddingTop"),10)+parseInt(D.$boxer.css("paddingBottom"),10),D.paddingHorizontal=parseInt(D.$boxer.css("paddingLeft"),10)+parseInt(D.$boxer.css("paddingRight"),10),h(),D.gallery.active&&q(),D.$window.on("resize.boxer",G.resize).on("keydown.boxer",r),D.$body.on("touchstart.boxer click.boxer","#boxer-overlay, #boxer .boxer-close",g).on("touchmove.boxer",C),D.gallery.active&&D.$boxer.on("touchstart.boxer click.boxer",".boxer-arrow",p),D.$overlay.stop().animate({opacity:D.options.opacity},D.options.duration),D.$boxer.stop().animate({opacity:1},D.options.duration,function(){n?i(f):o?j(f):v?t(f):w?s(f):x?u(D.$object):a.error("BOXER: '"+f+"' is not valid.")})}return x?D.$boxer:void 0}function e(){var a=0,b=0,c=0,d=D.isMobile?0:D.options.duration;D.isMobile||(a=(D.$window.width()-D.contentWidth-D.paddingHorizontal)/2,b=D.options.top<=0?(D.$window.height()-D.contentHeight-D.paddingVertical)/2:D.options.top,c=D.$arrows.outerHeight(),D.options.fixed!==!0&&(b+=D.$window.scrollTop()),D.$arrows.css({marginTop:(D.contentHeight-D.metaHeight-c)/2})),!D.visible&&D.isMobile&&D.gallery.active&&D.$content.on("touchstart.boxer",".boxer-image",w),(D.isMobile||D.options.fixed)&&D.$body.addClass("boxer-open"),D.$boxer.stop().animate({left:a,top:b},d),D.$container.show().stop().animate({height:D.containerHeight,width:D.containerWidth},d,function(){D.$content.stop().animate({opacity:1},D.options.duration),D.$boxer.removeClass("loading").find(".boxer-close").stop().animate({opacity:1},D.options.duration),D.visible=!0,D.options.callback.apply(D.$boxer),D.$window.trigger("open.boxer"),D.gallery.active&&o()})}function f(a){if(a=a||!1,D.visible){var b=0,c=0,d=0;D.isMobile||(b=(D.$window.width()-D.contentWidth-D.paddingHorizontal)/2,c=D.options.top<=0?(D.$window.height()-D.contentHeight-D.paddingVertical)/2:D.options.top,d=D.$arrows.outerHeight(),D.options.fixed!==!0&&(c+=D.$window.scrollTop()),D.$arrows.css({marginTop:(D.contentHeight-D.metaHeight-d)/2})),a?(D.$boxer.stop().animate({left:b,top:c},D.options.duration),D.$container.show().stop().animate({height:D.containerHeight,width:D.containerWidth})):(D.$boxer.css({left:b,top:c}),D.$container.css({height:D.containerHeight,width:D.containerWidth}))}}function g(b){C(b),"undefined"!=typeof D.$animatables&&(D.$animatables.stop().animate({opacity:0},D.options.duration,function(){a(this).remove()}),A(D.resizeTimer),D.$window.off(".boxer"),D.$body.off(".boxer").removeClass("boxer-open"),D.gallery.active&&D.$boxer.off(".boxer"),D.isMobile&&"image"===D.type&&D.gallery.active&&D.$container.off(".boxer"),D.$window.trigger("close.boxer"),D={})}function h(){var a=0,b=0;D.isMobile||(a=(D.$window.width()-D.$boxer.width()-D.paddingHorizontal)/2,b=D.options.top<=0?(D.$window.height()-D.$boxer.height()-D.paddingVertical)/2:D.options.top,D.options.fixed!==!0&&(b+=D.$window.scrollTop())),D.$boxer.css({left:a,top:b})}function i(b){D.$image=a("<img />"),D.$image.one("load.boxer",function(){var a=B(D.$image);D.naturalHeight=a.naturalHeight,D.naturalWidth=a.naturalWidth,D.options.retina&&(D.naturalHeight/=2,D.naturalWidth/=2),D.$content.prepend(D.$image),""===D.$caption.html()?D.$caption.hide():D.$caption.show(),l(0)&&e()}).attr("src",b).addClass("boxer-image"),(D.$image[0].complete||4===D.$image[0].readyState)&&D.$image.trigger("load")}function j(b){D.$videoWrapper=a('<div class="boxer-video-wrapper" />'),D.$video=a('<iframe class="boxer-video" />'),D.$video.attr("src",b).addClass("boxer-video").prependTo(D.$videoWrapper),D.$content.prepend(D.$videoWrapper),n(),e()}function k(a){var b=a.attr("title");return""!==b&&void 0!==b?'<p class="caption">'+b+"</p>":""}function l(a){return D.windowHeight=D.viewportHeight=0===a?D.$window.height():D.windowHeight,D.windowWidth=D.viewportWidth=0===a?D.$window.width():D.windowWidth,D.imageHeight=0===a?D.naturalHeight:D.$image.outerHeight(),D.imageWidth=0===a?D.naturalWidth:D.$image.outerWidth(),D.metaHeight=0===a?0:D.metaHeight,0===a&&(D.ratioHorizontal=D.imageHeight/D.imageWidth,D.ratioVertical=D.imageWidth/D.imageHeight,D.isWide=D.imageWidth>D.imageHeight),D.imageHeight<D.options.minHeight&&(D.options.minHeight=D.imageHeight),D.imageWidth<D.options.minWidth&&(D.options.minWidth=D.imageWidth),D.isMobile?(D.containerHeight=D.viewportHeight-D.paddingVertical,D.containerWidth=D.viewportWidth-D.paddingHorizontal,D.contentHeight=D.containerHeight-D.metaHeight,D.contentWidth=D.containerWidth,m(D),D.imageMarginTop=(D.contentHeight-D.targetImageHeight)/2,D.imageMarginLeft=(D.contentWidth-D.targetImageWidth)/2):(D.viewportHeight-=D.options.margin+D.paddingVertical+D.metaHeight,D.viewportWidth-=D.options.margin+D.paddingHorizontal,m(D),D.containerHeight=D.contentHeight=D.targetImageHeight,D.containerWidth=D.contentWidth=D.targetImageWidth,D.imageMarginTop=0,D.imageMarginLeft=0),D.$content.css({height:D.isMobile?D.contentHeight:"auto",width:D.contentWidth}),D.$meta.css({width:D.contentWidth}),D.$image.css({height:D.targetImageHeight,width:D.targetImageWidth,marginTop:D.imageMarginTop,marginLeft:D.imageMarginLeft}),D.metaHeight=D.$meta.outerHeight(!0),D.contentHeight+=D.metaHeight,D.isMobile||(D.containerHeight+=D.metaHeight),D.contentHeight>D.viewportHeight&&2>a?l(a+1):!0}function m(){var a=D.isMobile?D.contentHeight-D.options.margin:D.viewportHeight,b=D.isMobile?D.contentWidth-D.options.margin:D.viewportWidth;D.isWide?(D.targetImageWidth=b,D.targetImageHeight=D.targetImageWidth*D.ratioHorizontal,D.targetImageHeight>a&&(D.targetImageHeight=a,D.targetImageWidth=D.targetImageHeight*D.ratioVertical)):(D.targetImageHeight=a,D.targetImageWidth=D.targetImageHeight*D.ratioVertical,D.targetImageWidth>b&&(D.targetImageWidth=b,D.targetImageHeight=D.targetImageWidth*D.ratioHorizontal)),(D.targetImageWidth>D.imageWidth||D.targetImageHeight>D.imageHeight)&&(D.targetImageWidth=D.imageWidth,D.targetImageHeight=D.imageHeight),(D.targetImageWidth<D.options.minWidth||D.targetImageHeight<D.options.minHeight)&&(D.targetImageWidth<D.options.minWidth?(D.targetImageWidth=D.options.minWidth,D.targetImageHeight=D.targetImageWidth*D.ratioHorizontal):(D.targetImageHeight=D.options.minHeight,D.targetImageWidth=D.targetImageHeight*D.ratioVertical))}function n(){D.windowHeight=D.$window.height()-D.paddingVertical,D.windowWidth=D.$window.width()-D.paddingHorizontal,D.videoMarginTop=0,D.videoMarginLeft=0,D.isMobile?(D.$meta.css({width:D.windowWidth}),D.metaHeight=D.$meta.outerHeight(!0),D.contentHeight=D.windowHeight,D.contentWidth=D.windowWidth,D.videoWidth=D.windowWidth,D.videoHeight=D.videoWidth*D.options.videoRatio,D.videoHeight>D.windowHeight-D.metaHeight&&(D.videoHeight=D.windowHeight-D.metaHeight,D.videoWidth=D.videoHeight*D.options.videoRatio),D.videoMarginTop=(D.contentHeight-D.videoHeight)/2,D.videoMarginLeft=(D.contentWidth-D.videoWidth)/2):(D.windowHeight-=D.options.margin,D.windowWidth-=D.options.margin,D.videoWidth=D.options.videoWidth>D.windowWidth?D.windowWidth:D.options.videoWidth,D.videoHeight=D.videoWidth*D.options.videoRatio,D.contentHeight=D.videoHeight,D.contentWidth=D.videoWidth),D.$content.css({height:D.isMobile?D.contentHeight:"auto",width:D.contentWidth}),D.$meta.css({width:D.contentWidth}),D.$videoWrapper.css({height:D.videoHeight,width:D.videoWidth,marginTop:D.videoMarginTop,marginLeft:D.videoMarginLeft}),D.isMobile||(D.metaHeight=D.$meta.outerHeight(!0),D.contentHeight=D.videoHeight+D.metaHeight),D.containerHeight=D.contentHeight,D.containerWidth=D.contentWidth=D.videoWidth}function o(){var b="";D.gallery.index>0&&(b=D.gallery.$items.eq(D.gallery.index-1).attr("href"),b.indexOf("youtube.com/embed")<0&&b.indexOf("player.vimeo.com/video")<0&&a('<img src="'+b+'">')),D.gallery.index<D.gallery.total&&(b=D.gallery.$items.eq(D.gallery.index+1).attr("href"),b.indexOf("youtube.com/embed")<0&&b.indexOf("player.vimeo.com/video")<0&&a('<img src="'+b+'">'))}function p(b){C(b);var c=a(this);c.hasClass("disabled")||(D.$boxer.addClass("loading"),D.gallery.index+=c.hasClass("next")?1:-1,D.gallery.index>D.gallery.total&&(D.gallery.index=D.gallery.total),D.gallery.index<0&&(D.gallery.index=0),D.$content.stop().animate({opacity:0},D.options.duration,function(){"undefined"!=typeof D.$image&&D.$image.remove(),"undefined"!=typeof D.$videoWrapper&&D.$videoWrapper.remove(),D.$target=D.gallery.$items.eq(D.gallery.index),D.$caption.html(D.options.formatter.apply(D.$body,[D.$target])),D.$position.find(".current").html(D.gallery.index+1);var a=D.$target.attr("href"),b=a.indexOf("youtube.com/embed")>-1||a.indexOf("player.vimeo.com/video")>-1;b?j(a):i(a),q()}))}function q(){D.$arrows.removeClass("disabled"),0===D.gallery.index&&D.$arrows.filter(".previous").addClass("disabled"),D.gallery.index===D.gallery.total&&D.$arrows.filter(".next").addClass("disabled")}function r(a){!D.gallery.active||37!==a.keyCode&&39!==a.keyCode?27===a.keyCode&&D.$boxer.find(".boxer-close").trigger("click"):(C(a),D.$arrows.filter(37===a.keyCode?".previous":".next").trigger("click"))}function s(b){var c=a(b).find(">:first-child").clone();u(c)}function t(b){b+=b.indexOf("?")>-1?"&"+F.requestKey+"=true":"?"+F.requestKey+"=true";var c=a('<iframe class="boxer-iframe" src="'+b+'" />');u(c)}function u(a){D.$content.append(a),v(a),e()}function v(a){D.objectHeight=a.outerHeight(!0),D.objectWidth=a.outerWidth(!0),D.windowHeight=D.$window.height()-D.paddingVertical,D.windowWidth=D.$window.width()-D.paddingHorizontal,D.dataHeight=D.$target.data("height"),D.dataWidth=D.$target.data("width"),D.maxHeight=D.windowHeight<0?F.minHeight:D.windowHeight,D.isIframe=a.is("iframe"),D.objectMarginTop=0,D.objectMarginLeft=0,D.isMobile||(D.windowHeight-=D.options.margin,D.windowWidth-=D.options.margin),D.contentHeight=void 0!==D.dataHeight?D.dataHeight:D.isIframe?D.windowHeight:D.objectHeight,D.contentWidth=void 0!==D.dataWidth?D.dataWidth:D.isIframe?D.windowWidth:D.objectWidth,D.isIframe&&D.isMobile&&(D.contentHeight=D.windowHeight,D.contentWidth=D.windowWidth),D.containerHeight=D.contentHeight,D.containerWidth=D.contentWidth,D.$content.css({height:D.contentHeight,width:D.contentWidth})}function w(a){if(C(a),A(D.touchTimer),!D.isAnimating){var b="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;D.xStart=b?b.pageX:a.clientX,D.leftPosition=0,D.touchMax=1/0,D.touchMin=-1/0,D.edge=.25*D.contentWidth,0===D.gallery.index&&(D.touchMax=0),D.gallery.index===D.gallery.total&&(D.touchMin=0),D.$boxer.on("touchmove.boxer",x).one("touchend.boxer",y)}}function x(a){var b="undefined"!=typeof a.originalEvent.targetTouches?a.originalEvent.targetTouches[0]:null;D.delta=D.xStart-(b?b.pageX:a.clientX),D.delta>20&&C(a),D.canSwipe=!0;var c=-D.delta;c<D.touchMin&&(c=D.touchMin,D.canSwipe=!1),c>D.touchMax&&(c=D.touchMax,D.canSwipe=!1),D.$image.css({transform:"translate3D("+c+"px,0,0)"}),D.touchTimer=z(D.touchTimer,300,function(){y(a)})}function y(a){C(a),A(D.touchTimer),D.$boxer.off("touchmove.boxer touchend.boxer"),D.delta&&(D.$boxer.addClass("animated"),D.swipe=!1,D.canSwipe&&(D.delta>D.edge||D.delta<-D.edge)?(D.swipe=!0,D.delta<=D.leftPosition?D.$image.css({transform:"translate3D("+D.contentWidth+"px,0,0)"}):D.$image.css({transform:"translate3D("+-D.contentWidth+"px,0,0)"})):D.$image.css({transform:"translate3D(0,0,0)"}),D.swipe&&D.$arrows.filter(D.delta<=D.leftPosition?".previous":".next").trigger("click"),z(D.resetTimer,D.options.duration,function(){D.$boxer.removeClass("animated")}))}function z(a,b,c){return A(a),setTimeout(c,b)}function A(a){a&&(clearTimeout(a),a=null)}function B(a){var b=a[0],c=new Image;return"undefined"!=typeof b.naturalHeight?{naturalHeight:b.naturalHeight,naturalWidth:b.naturalWidth}:"img"===b.tagName.toLowerCase()?(c.src=b.src,{naturalHeight:c.height,naturalWidth:c.width}):!1}function C(a){a.preventDefault&&(a.stopPropagation(),a.preventDefault())}var D={},E=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(b.navigator.userAgent||b.navigator.vendor||b.opera),F={callback:a.noop,customClass:"",duration:250,fixed:!1,formatter:a.noop,height:100,labels:{close:"Close",count:"of",next:"Next",previous:"Previous"},margin:100,minHeight:100,minWidth:100,mobile:!1,opacity:.75,retina:!1,requestKey:"boxer",top:0,videoRatio:.5625,videoWidth:600,width:100},G={defaults:function(b){return F=a.extend(F,b||{}),a(this)},destroy:function(){return g(),a(this).off(".boxer")},resize:function(){return"undefined"!=typeof D.$boxer&&("element"===D.type?v(D.$content.find(">:first-child")):"image"===D.type?l(0):"video"===D.type&&n(),f()),a(this)}};a.fn.boxer=function(a){return G[a]?G[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a.boxer=function(c,e){return G[c]?G[c].apply(b,Array.prototype.slice.call(arguments,1)):d.apply(b,[a.Event("click",{data:a.extend({$object:c},F,e||{})})])}}(jQuery,window);